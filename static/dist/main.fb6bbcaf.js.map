{"version":3,"sources":["js/main.js"],"names":["c2","require","ds2","fs2","a2","c3","sampler","Tone","Sampler","urls","C2","A2","C3","release","baseUrl","toDestination","PianoKey","note","shortcut","polygon","pressed","console","log","classList","add","triggerAttack","remove","triggerRelease","pianoKeys","document","querySelector","addEventListener","evt","repeat","k","key","playNote","stopNote","lastClicked","pianoPolygons","getElementsByClassName","matchingKey","findMatchingKey","cancelable","preventDefault","stopPropagation","dataset","kbBtn","getElementById","kbDiv","toggle"],"mappings":"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","file":"main.fb6bbcaf.js","sourceRoot":"..","sourcesContent":["\"use strict\";\r\n// The PianoKey class contains every relevant information and thing to create a piano key and play it.\r\n\r\nconst c2 = require('../assets/audio/C2.ogg');\r\nconst ds2 = require('../assets/audio/Ds2.ogg');\r\nconst fs2 = require('../assets/audio/Fs2.ogg');\r\nconst a2 = require('../assets/audio/A2.ogg');\r\nconst c3 = require('../assets/audio/C3.ogg');\r\nconst sampler = new Tone.Sampler({\r\n    urls: {\r\n        C2: c2,\r\n        \"D#2\": ds2,\r\n        \"F#2\": fs2,\r\n        A2: a2,\r\n        C3: c3,\r\n    },\r\n    release: 1,\r\n    baseUrl: \"\"\r\n}).toDestination();\r\nclass PianoKey {\r\n    constructor(note, shortcut, polygon) {\r\n        this.note = note\r\n        this.shortcut = shortcut\r\n        this.polygon = polygon\r\n        this.pressed = false\r\n    }\r\n    print() {\r\n        console.log({ 'note': this.note }, { 'shortcut': this.shortcut }, { 'polygon': this.polygon }, { 'pressed': this.pressed })\r\n    }\r\n    // Clears timeout to stop the fading out, and starts the sound from the beginning with max volume.\r\n    playNote() {\r\n        this.pressed = true;\r\n        this.polygon.classList.add('active')\r\n        sampler.triggerAttack(this.note)\r\n    }\r\n    stopNote() {\r\n        this.pressed = false;\r\n        this.polygon.classList.remove('active')\r\n        sampler.triggerRelease(this.note)\r\n    }\r\n}\r\n\r\n// Creates two arrays which will be used to create pianoKey objects that we will use in our piano. \r\n\r\nconst pianoKeys = [\r\n    new PianoKey('C2', \"a\", document.querySelector('.c2')),\r\n    new PianoKey('D2', \"s\", document.querySelector('.d2')),\r\n    new PianoKey('E2', \"d\", document.querySelector('.e2')),\r\n    new PianoKey('F2', \"f\", document.querySelector('.f2')),\r\n    new PianoKey('G2', \"g\", document.querySelector('.g2')),\r\n    new PianoKey('A2', \"h\", document.querySelector('.a2')),\r\n    new PianoKey('B2', \"j\", document.querySelector('.b2')),\r\n    new PianoKey('C3', \"k\", document.querySelector('.c3')),\r\n    new PianoKey(\"C#2\", \"w\", document.querySelector('.cs2')),\r\n    new PianoKey(\"D#2\", \"e\", document.querySelector('.ds2')),\r\n    new PianoKey(\"F#2\", \"t\", document.querySelector('.fs2')),\r\n    new PianoKey(\"G#2\", \"y\", document.querySelector('.gs2')),\r\n    new PianoKey(\"A#2\", \"u\", document.querySelector('.as2')),\r\n]\r\n\r\ndocument.addEventListener('keydown', (evt) => {\r\n    if (evt.repeat === true) return\r\n    for (const k of pianoKeys) {\r\n        if (evt.key === k.shortcut) {\r\n            if (k.pressed) return\r\n            k.playNote()\r\n            return\r\n        }\r\n    }\r\n})\r\ndocument.addEventListener('keyup', (evt) => {\r\n    for (const k of pianoKeys) {\r\n        if (evt.key === k.shortcut) {\r\n            k.stopNote()\r\n            return\r\n        }\r\n    }\r\n})\r\n\r\nlet lastClicked = null;\r\nconst pianoPolygons = document.getElementsByClassName('piano-key')\r\nfor (const polygon of pianoPolygons) {\r\n    const matchingKey = findMatchingKey(polygon)\r\n    polygon.addEventListener(\"touchstart\", (evt) => {\r\n        if (evt.cancelable) {\r\n            evt.preventDefault();\r\n        }\r\n        evt.stopPropagation();\r\n        matchingKey.playNote();\r\n    });\r\n    // This solution is not perfect. If I slide my finger outside the piano container the sound will stop but the \r\n    polygon.addEventListener(\"touchend\", (evt) => {\r\n        if (evt.cancelable) {\r\n            evt.preventDefault();\r\n        }\r\n        evt.stopPropagation();\r\n        matchingKey.stopNote();\r\n    });\r\n    // polygon.addEventListener('mousedown', (evt) => {\r\n    //     if (evt.cancelable) {\r\n    //         evt.preventDefault();\r\n    //     }\r\n    //     evt.stopPropagation();\r\n    //     matchingKey.playNote();\r\n    //     lastClicked = matchingKey\r\n    // })\r\n    // polygon.addEventListener('mouseup', (evt) => {\r\n    //     if (evt.cancelable) {\r\n    //         evt.preventDefault();\r\n    //     }\r\n    //     evt.stopPropagation();\r\n\r\n    //     if (lastClicked !== null) {\r\n    //         lastClicked.stopNote()\r\n    //     }\r\n    // })\r\n}\r\nfunction findMatchingKey(polygon) {\r\n    for (const key of pianoKeys) {\r\n        if (polygon.dataset.note === key.note) {\r\n            return key\r\n        }\r\n    }\r\n}\r\n// function startup() {\r\n//     const piano = document.getElementById(\"canvas\");\r\n//     el.addEventListener(\"touchend\", handleEnd, false);\r\n//     el.addEventListener(\"touchcancel\", handleCancel, false);\r\n//     el.addEventListener(\"touchmove\", handleMove, false);\r\n// }\r\n\r\n// document.addEventListener(\"DOMContentLoaded\", startup);\r\n\r\nconst kbBtn = document.getElementById('keybindings-btn')\r\nconst kbDiv = document.getElementById('keybindings-div')\r\n\r\nkbBtn.addEventListener('click', () => {\r\n    kbBtn.classList.toggle('clicked')\r\n    kbDiv.classList.toggle('hidden')\r\n})"]}