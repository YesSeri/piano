{"version":3,"sources":["js/main.js"],"names":["c2","require","ds2","fs2","a2","c3","sampler","Tone","Sampler","urls","release","baseUrl","toDestination","PianoKey","note","shortcut","rects","pressed","console","log","classList","add","triggerAttack","remove","triggerRelease","pianoKeys","document","querySelector","startEventListeners","addEventListener","evt","repeat","k","key","playNote","stopNote","lastClicked","pianoRects","getElementsByClassName","matchingKey","findMatchingKey","cancelable","preventDefault","stopPropagation","setTimeout","pianoContainer","getElementById","dataset","window","kbBtn","kbDiv","toggle"],"mappings":"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","file":"main.ac0540e1.js","sourceRoot":"..","sourcesContent":["\"use strict\";\r\n// The PianoKey class contains every relevant information and thing to create a piano key and play it.\r\n\r\nconst c2 = require('../assets/audio/C2.ogg');\r\nconst ds2 = require('../assets/audio/Ds2.ogg');\r\nconst fs2 = require('../assets/audio/Fs2.ogg');\r\nconst a2 = require('../assets/audio/A2.ogg');\r\nconst c3 = require('../assets/audio/C3.ogg');\r\nconst sampler = new Tone.Sampler({\r\n    urls: {\r\n        \"C2\": c2,\r\n        \"D#2\": ds2,\r\n        \"F#2\": fs2,\r\n        \"A2\": a2,\r\n        \"C3\": c3,\r\n    },\r\n    release: 1,\r\n    baseUrl: \"\"\r\n}).toDestination();\r\nclass PianoKey {\r\n    constructor(note, shortcut, rects) {\r\n        this.note = note\r\n        this.shortcut = shortcut\r\n        this.rects = rects\r\n        this.pressed = false\r\n    }\r\n    print() {\r\n        console.log({ 'note': this.note }, { 'shortcut': this.shortcut }, { 'rects': this.rects }, { 'pressed': this.pressed })\r\n    }\r\n    // Clears timeout to stop the fading out, and starts the sound from the beginning with max volume.\r\n    playNote() {\r\n        this.pressed = true;\r\n        this.rects.classList.add('active')\r\n        sampler.triggerAttack(this.note)\r\n    }\r\n    stopNote() {\r\n        this.pressed = false;\r\n        this.rects.classList.remove('active')\r\n        sampler.triggerRelease(this.note)\r\n    }\r\n}\r\n\r\n// Creates two arrays which will be used to create pianoKey objects that we will use in our piano. \r\n\r\nconst pianoKeys = [\r\n    new PianoKey('C2', \"a\", document.querySelector('.c2')),\r\n    new PianoKey('D2', \"s\", document.querySelector('.d2')),\r\n    new PianoKey('E2', \"d\", document.querySelector('.e2')),\r\n    new PianoKey('F2', \"f\", document.querySelector('.f2')),\r\n    new PianoKey('G2', \"g\", document.querySelector('.g2')),\r\n    new PianoKey('A2', \"h\", document.querySelector('.a2')),\r\n    new PianoKey('B2', \"j\", document.querySelector('.b2')),\r\n    new PianoKey('C3', \"k\", document.querySelector('.c3')),\r\n    new PianoKey(\"C#2\", \"w\", document.querySelector('.cs2')),\r\n    new PianoKey(\"D#2\", \"e\", document.querySelector('.ds2')),\r\n    new PianoKey(\"F#2\", \"t\", document.querySelector('.fs2')),\r\n    new PianoKey(\"G#2\", \"y\", document.querySelector('.gs2')),\r\n    new PianoKey(\"A#2\", \"u\", document.querySelector('.as2')),\r\n]\r\nwindow.addEventListener(\"load\", startEventListeners);\r\nfunction startEventListeners() {\r\n\r\n    document.addEventListener('keydown', (evt) => {\r\n        if (evt.repeat === true) return\r\n        for (const k of pianoKeys) {\r\n            if (evt.key === k.shortcut) {\r\n                if (k.pressed) return\r\n                k.playNote()\r\n                return\r\n            }\r\n        }\r\n    })\r\n    document.addEventListener('keyup', (evt) => {\r\n        for (const k of pianoKeys) {\r\n            if (evt.key === k.shortcut) {\r\n                k.stopNote()\r\n                return\r\n            }\r\n        }\r\n    })\r\n\r\n    let lastClicked = null;\r\n    const pianoRects = document.getElementsByClassName('piano-key')\r\n    for (const rects of pianoRects) {\r\n        const matchingKey = findMatchingKey(rects)\r\n        rects.addEventListener(\"touchstart\", (evt) => {\r\n            if (evt.cancelable) {\r\n                evt.preventDefault();\r\n            }\r\n            evt.stopPropagation();\r\n            matchingKey.playNote();\r\n        });\r\n        // This solution is not perfect. If I slide my finger outside the piano container the sound will stop but the \r\n        rects.addEventListener(\"touchend\", (evt) => {\r\n            if (evt.cancelable) {\r\n                evt.preventDefault();\r\n            }\r\n            evt.stopPropagation();\r\n            matchingKey.stopNote();\r\n        });\r\n        rects.addEventListener('mousedown', (evt) => {\r\n            if (evt.cancelable) {\r\n                evt.preventDefault();\r\n            }\r\n            evt.stopPropagation();\r\n            matchingKey.playNote();\r\n            lastClicked = matchingKey\r\n        })\r\n        rects.addEventListener('mouseup', (evt) => {\r\n            if (evt.cancelable) {\r\n                evt.preventDefault();\r\n            }\r\n            evt.stopPropagation();\r\n\r\n            if (lastClicked !== null) {\r\n                lastClicked.stopNote()\r\n            }\r\n        })\r\n    }\r\n\r\n    setTimeout(() => {\r\n        const pianoContainer = document.getElementById('piano-container')\r\n        const loadingDiv = document.getElementById('loading-div')\r\n        loadingDiv.classList.add('hidden')\r\n        pianoContainer.classList.remove('piano-hidden')\r\n    }, 500)\r\n\r\n}\r\n\r\n\r\n\r\nfunction findMatchingKey(rects) {\r\n    for (const key of pianoKeys) {\r\n        if (rects.dataset.note === key.note) {\r\n            return key\r\n        }\r\n    }\r\n}\r\n// function startup() {\r\n//     const piano = document.getElementById(\"canvas\");\r\n//     el.addEventListener(\"touchend\", handleEnd, false);\r\n//     el.addEventListener(\"touchcancel\", handleCancel, false);\r\n//     el.addEventListener(\"touchmove\", handleMove, false);\r\n// }\r\n\r\n// document.addEventListener(\"DOMContentLoaded\", startup);\r\n\r\nconst kbBtn = document.getElementById('keybindings-btn')\r\nconst kbDiv = document.getElementById('keybindings-div')\r\n\r\nkbBtn.addEventListener('click', () => {\r\n    kbBtn.classList.toggle('clicked')\r\n    kbDiv.classList.toggle('hidden')\r\n})"]}