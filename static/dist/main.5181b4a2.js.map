{"version":3,"sources":["js/main.js"],"names":["c2","require","ds2","fs2","a2","c3","sampler","Tone","Sampler","urls","release","baseUrl","toDestination","PianoKey","note","shortcut","rects","pressed","console","log","classList","add","triggerAttack","remove","triggerRelease","pianoKeys","document","querySelector","startEventListeners","addEventListener","evt","repeat","k","key","playNote","stopNote","lastClicked","pianoRects","getElementsByClassName","matchingKey","findMatchingKey","cancelable","preventDefault","stopPropagation","fsBtn","createElement","test","navigator","userAgent","innerContainer","getElementById","innerText","appendChild","pianoContainer","requestFullscreen","webkitRequestFullscreen","msRequestFullscreen","svg","contains","isFullscreen","setTimeout","updateFullscreenStylesheet","sheet","screen","width","height","innerHTML","getSheetInnerHTML","createFullscreenStylesheet","id","dataset","window","body","kbBtn","kbDiv","toggle"],"mappings":"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","file":"main.5181b4a2.js","sourceRoot":"..","sourcesContent":["\"use strict\";\r\n// The PianoKey class contains every relevant information and thing to create a piano key and play it.\r\n// The awesome library tone.js is imported in index.html script.\r\nconst c2 = require('../assets/audio/C2.ogg');\r\nconst ds2 = require('../assets/audio/Ds2.ogg');\r\nconst fs2 = require('../assets/audio/Fs2.ogg');\r\nconst a2 = require('../assets/audio/A2.ogg');\r\nconst c3 = require('../assets/audio/C3.ogg');\r\n\r\nconst sampler = new Tone.Sampler({\r\n    urls: {\r\n        \"C2\": c2,\r\n        \"D#2\": ds2,\r\n        \"F#2\": fs2,\r\n        \"A2\": a2,\r\n        \"C3\": c3,\r\n    },\r\n    release: 1,\r\n    baseUrl: \"\"\r\n}).toDestination();\r\nclass PianoKey {\r\n    constructor(note, shortcut, rects) {\r\n        this.note = note\r\n        this.shortcut = shortcut\r\n        this.rects = rects\r\n        this.pressed = false\r\n    }\r\n    print() {\r\n        console.log({ 'note': this.note }, { 'shortcut': this.shortcut }, { 'rects': this.rects }, { 'pressed': this.pressed })\r\n    }\r\n    playNote() {\r\n        this.pressed = true;\r\n        this.rects.classList.add('active')\r\n        sampler.triggerAttack(this.note)\r\n    }\r\n    stopNote() {\r\n        this.pressed = false;\r\n        this.rects.classList.remove('active')\r\n        sampler.triggerRelease(this.note)\r\n    }\r\n}\r\n\r\nconst pianoKeys = [\r\n    new PianoKey('C2', \"a\", document.querySelector('.c2')),\r\n    new PianoKey('D2', \"s\", document.querySelector('.d2')),\r\n    new PianoKey('E2', \"d\", document.querySelector('.e2')),\r\n    new PianoKey('F2', \"f\", document.querySelector('.f2')),\r\n    new PianoKey('G2', \"g\", document.querySelector('.g2')),\r\n    new PianoKey('A2', \"h\", document.querySelector('.a2')),\r\n    new PianoKey('B2', \"j\", document.querySelector('.b2')),\r\n    new PianoKey('C3', \"k\", document.querySelector('.c3')),\r\n    new PianoKey(\"C#2\", \"w\", document.querySelector('.cs2')),\r\n    new PianoKey(\"D#2\", \"e\", document.querySelector('.ds2')),\r\n    new PianoKey(\"F#2\", \"t\", document.querySelector('.fs2')),\r\n    new PianoKey(\"G#2\", \"y\", document.querySelector('.gs2')),\r\n    new PianoKey(\"A#2\", \"u\", document.querySelector('.as2')),\r\n]\r\n// I wait with initiating eventlisterners until everything is loaded, including the sound library ToneJS. \r\nwindow.addEventListener(\"load\", startEventListeners);\r\nfunction startEventListeners() {\r\n    document.addEventListener('keydown', (evt) => {\r\n        if (evt.repeat === true) return\r\n        for (const k of pianoKeys) {\r\n            if (evt.key === k.shortcut) {\r\n                if (k.pressed) return\r\n                k.playNote()\r\n                return\r\n            }\r\n        }\r\n    })\r\n    document.addEventListener('keyup', (evt) => {\r\n        for (const k of pianoKeys) {\r\n            if (evt.key === k.shortcut) {\r\n                k.stopNote()\r\n                return\r\n            }\r\n        }\r\n    })\r\n\r\n    let lastClicked = null;\r\n    const pianoRects = document.getElementsByClassName('piano-key')\r\n    for (const rects of pianoRects) {\r\n        const matchingKey = findMatchingKey(rects)\r\n        rects.addEventListener(\"touchstart\", (evt) => {\r\n            if (evt.cancelable) {\r\n                evt.preventDefault();\r\n            }\r\n            evt.stopPropagation();\r\n            matchingKey.playNote();\r\n        });\r\n        // This solution is not perfect. I can't slid my finger along the keyboard to play a lot of notes.\r\n        rects.addEventListener(\"touchend\", (evt) => {\r\n            if (evt.cancelable) {\r\n                evt.preventDefault();\r\n            }\r\n            evt.stopPropagation();\r\n            matchingKey.stopNote();\r\n        });\r\n        rects.addEventListener('mousedown', (evt) => {\r\n            matchingKey.playNote();\r\n            lastClicked = matchingKey\r\n        })\r\n        rects.addEventListener('mouseup', (evt) => {\r\n            if (lastClicked !== null) {\r\n                lastClicked.stopNote()\r\n            }\r\n        })\r\n    }\r\n    // I only want to show a fullscreen button if the user is using a mobile device. There is no need for it on a computer.\r\n    const fsBtn = document.createElement(\"BUTTON\")\r\n    if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {\r\n        const innerContainer = document.getElementById('inner-container')\r\n        fsBtn.innerText = \"Fullscreen\"\r\n        innerContainer.appendChild(fsBtn)\r\n        console.log(\"Fullscreen button added, because you are using a mobile device.\");\r\n    } else {\r\n        console.log(\"Fullscreen has not been added, because you are not using a mobile device.\");\r\n    }\r\n    // Requests fullscreen when clicked. Several versions for compatibilit reasons. \r\n    fsBtn.addEventListener('click', () => {\r\n        const pianoContainer = document.getElementById('piano-container')\r\n        if (pianoContainer.requestFullscreen) {\r\n            pianoContainer.requestFullscreen();\r\n        } else if (pianoContainer.webkitRequestFullscreen) { /* Safari */\r\n            pianoContainer.webkitRequestFullscreen();\r\n        } else if (pianoContainer.msRequestFullscreen) { /* IE11 */\r\n            pianoContainer.msRequestFullscreen();\r\n        }\r\n    })\r\n    document.addEventListener('fullscreenchange', () => {\r\n        const svg = document.getElementById('piano-svg')\r\n        if (svg.classList.contains('fullscreen-res')) {\r\n            svg.classList.remove('fullscreen-res')\r\n            isFullscreen = false;\r\n        } else {\r\n            svg.classList.add('fullscreen-res')\r\n            isFullscreen = true;\r\n        }\r\n    }, false);\r\n    setTimeout(() => {\r\n        const pianoContainer = document.getElementById('piano-container')\r\n        const loadingDiv = document.getElementById('loading-div')\r\n        loadingDiv.classList.add('hidden')\r\n        pianoContainer.classList.remove('piano-hidden')\r\n    }, 300)\r\n\r\n}\r\n\r\n\r\nwindow.addEventListener(\"orientationchange\", updateFullscreenStylesheet);\r\nfunction updateFullscreenStylesheet() {\r\n    const sheet = document.getElementById('fs-stylesheet')\r\n    const { width, height } = screen\r\n    if (sheet === null) return\r\n    // When it is fullscreen the rotation somehow registers the height and width of what it was before the rotation, at least on a galaxy s20, so I need to send it switched.\r\n    sheet.innerHTML = isFullscreen ? getSheetInnerHTML(height, width) : getSheetInnerHTML(width, height)\r\n}\r\n// This css sheet is created here beacuse I need to assign it values from depending on how big the screen is.\r\nfunction createFullscreenStylesheet() {\r\n    const sheet = document.createElement('style')\r\n    sheet.id = 'fs-stylesheet'\r\n    sheet.innerHTML = getSheetInnerHTML(screen.width, screen.height)\r\n    return sheet;\r\n}\r\nfunction getSheetInnerHTML(width, height) {\r\n    return `\r\n#piano-svg.fullscreen-res {\r\n    max-width: none;\r\n    width: ${width}px;\r\n    height: ${height}px;\r\n}`\r\n}\r\n\r\ndocument.body.appendChild(createFullscreenStylesheet());\r\n\r\nfunction findMatchingKey(rects) {\r\n    for (const key of pianoKeys) {\r\n        if (rects.dataset.note === key.note) {\r\n            return key\r\n        }\r\n    }\r\n}\r\n\r\nconst kbBtn = document.getElementById('keybindings-btn')\r\nconst kbDiv = document.getElementById('keybindings-div')\r\n\r\n// This toggles the visibility of the keybindings.\r\nkbBtn.addEventListener('click', () => {\r\n    kbBtn.classList.toggle('clicked')\r\n    kbDiv.classList.toggle('hidden')\r\n})"]}